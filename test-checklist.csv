Category,Test ID,Test Name,Description,Expected Result,Test File,Validation Method,Status
Scan Mode,1.1,URL Mode - External Target,ZAP scans an external URL (demo.testfire.net),Workflow completes and finds vulnerabilities,test-zap-url-mode.yml,Check workflow passes and report shows 10+ vulnerabilities,
Scan Mode,1.2,Docker Mode - Juice Shop,ZAP scans Juice Shop container,Container starts and ZAP finds vulnerabilities,test-zap-docker-juiceshop.yml,Verify container logs show requests and report has findings,
Scan Mode,1.3,Docker Mode - DVWA,ZAP scans DVWA container,Container starts and ZAP finds vulnerabilities,test-zap-docker-dvwa.yml,Verify DVWA specific vulnerabilities detected,
Scan Mode,1.4,Docker Mode - Podinfo,ZAP scans clean Podinfo app,Container starts with minimal findings,test-zap-docker-podinfo.yml,Verify scan completes with low severity findings only,
Scan Mode,1.5,Compose Mode - Multi-Container,ZAP scans services from docker-compose,All services start and ZAP scans target,test-zap-compose-mode.yml,Verify all containers started and scan completed,
Scan Type,2.1,Baseline Scan - Juice Shop,Passive ZAP scan against Juice Shop,Fast scan with passive checks only,test-zap-docker-juiceshop.yml,Duration < 5 min; finds header issues; no XSS/SQLi,
Scan Type,2.2,Full Scan - Juice Shop,Active ZAP scan against Juice Shop,Longer scan with active probing,test-zap-docker-juiceshop.yml,Duration > 10 min; finds XSS/SQLi; spider ran,
Scan Type,2.3,API Scan - Juice Shop,API-focused scan with OpenAPI spec,API endpoints tested specifically,test-zap-docker-juiceshop.yml,API spec loaded; all endpoints tested,
Scan Type,2.4,Baseline Scan - DVWA,Passive scan against DVWA,Finds security header issues,test-zap-docker-dvwa.yml,Completes quickly with passive findings,
Scan Type,2.5,Full Scan - DVWA,Active scan against DVWA,Finds XSS and SQL injection,test-zap-docker-dvwa.yml,Detects DVWA's intentional vulnerabilities,
Scan Type,2.6,Baseline Scan - URL Mode,Passive scan of external target,Finds issues on testfire.net,test-zap-url-mode.yml,Detects known testfire vulnerabilities,
Scan Type,2.7,Full Scan - URL Mode,Active scan of external target,Comprehensive scan of testfire.net,test-zap-url-mode.yml,Longer duration with more findings,
Threshold,3.1,Threshold None - Should Pass,Vulnerable app with threshold=none,Workflow passes regardless of findings,test-zap-thresholds.yml,Workflow status = success; findings reported,
Threshold,3.2,Threshold Informational - Should Fail,Vulnerable app with threshold=informational,Workflow fails on any finding,test-zap-thresholds.yml,Workflow status = failure; clear error message,
Threshold,3.3,Threshold Low - Should Fail,Vulnerable app with threshold=low,Workflow fails on low+ severity,test-zap-thresholds.yml,Workflow status = failure; threshold exceeded message,
Threshold,3.4,Threshold Medium - Should Fail,Vulnerable app with threshold=medium,Workflow fails on medium+ severity,test-zap-thresholds.yml,Workflow status = failure; correct severity triggered,
Threshold,3.5,Threshold High - Variable,Vulnerable app with threshold=high,Workflow fails only on high severity,test-zap-thresholds.yml,Passes if no high; fails if high severity found,
Threshold,3.6,Podinfo with High Threshold,Clean app with threshold=high,Should pass as podinfo is secure,test-zap-docker-podinfo.yml,Workflow passes; low findings only,
Integration,4.1,ZAP is Opt-In,Call workflow with scanners='all',ZAP does NOT run,test-zap-integration.yml,No ZAP job appears; only SAST scanners run,
Integration,4.2,ZAP with Other Scanners,Run trivy+semgrep+zap together,All three scanners complete,test-zap-integration.yml,Separate reports for each; no conflicts,
Integration,4.3,ZAP Only,Run only ZAP scanner,Only ZAP executes,test-zap-integration.yml,ZAP job runs; no other scanner jobs,
Integration,4.4,Works in PR Workflow,Test pr-reusable-security-hardening.yml,Same functionality in PR context,Manual test with PR workflow,No PR-specific issues,
Configuration,5.1,Custom Port Mapping - 3000,Juice Shop on port 3000,Port mapping works correctly,test-zap-docker-juiceshop.yml,ZAP reaches localhost:3000,
Configuration,5.2,Custom Port Mapping - 80,DVWA on port 80,Port mapping works correctly,test-zap-docker-dvwa.yml,ZAP reaches localhost:80,
Configuration,5.3,Custom Port Mapping - 9898,Podinfo on port 9898,Port mapping works correctly,test-zap-docker-podinfo.yml,ZAP reaches localhost:9898,
Configuration,5.4,Multiple Targets via Compose,docker-compose with multiple services,Each service accessible,test-zap-compose-mode.yml,All defined services reachable,
Reporting,6.1,HTML Report Generated,Any ZAP scan,HTML report created,All test files,HTML artifact exists and is viewable,
Reporting,6.2,JSON Report Generated,Any ZAP scan,JSON report created and parseable,All test files,JSON artifact exists; validates with jq,
Reporting,6.3,GitHub Summary Created,Any ZAP scan,Summary appears on Actions page,All test files,Summary shows vuln counts and severity,
Reporting,6.4,Artifact Upload,Any ZAP scan,Reports uploaded as artifacts,All test files,Artifact downloadable with correct retention,
Reporting,6.5,Report Shows Scan Type,Different scan types,Report indicates scan mode,All test files,Report clearly states baseline/full/api,
Reporting,6.6,Vulnerability Details,Any scan with findings,Details include CWE and severity,All test files,Each vuln has CWE; severity is correct,
Error Handling,7.1,Invalid Docker Image,Non-existent docker image,Clear error message,Manual test needed,Error indicates image pull failure,
Error Handling,7.2,Unreachable URL,Invalid or offline URL,Clear connection error,Manual test needed,Error message indicates connectivity issue,
Error Handling,7.3,Missing Required Parameter,Omit zap_target_url,Workflow fails immediately,Manual test needed,Error about missing parameter,
Error Handling,7.4,Invalid Scan Mode,Provide invalid scan_mode value,Validation error,Manual test needed,Clear error about invalid mode,
Error Handling,7.5,Container Startup Failure,Container that fails to start,Clear error handling,Manual test needed,Error indicates container start issue,
Error Handling,7.6,Timeout Handling,Scan that exceeds timeout,Graceful timeout with partial results,Manual test needed,Timeout message; partial results saved if possible,
Performance,8.1,Baseline Scan Duration,Baseline scan timing,Completes in under 5 minutes,test-zap-docker-juiceshop.yml,Check workflow duration,
Performance,8.2,Full Scan Duration,Full scan timing,Takes significantly longer than baseline,test-zap-docker-juiceshop.yml,Compare durations; full > 2x baseline,
Performance,8.3,Multiple Scans in Parallel,Run multiple workflows simultaneously,No resource conflicts,Run multiple tests at once,All complete without OOM errors,
Performance,8.4,Container Cleanup,After scan completion,No orphaned containers remain,All docker tests,Run docker ps after workflow; no leftovers,
Functional,9.1,ZAP Container Starts,ZAP proxy container initialization,ZAP container starts successfully,All test files,Workflow logs show ZAP started,
Functional,9.2,Target Application Accessible,App reachability check,ZAP can reach target app,All test files,Logs show successful connection,
Functional,9.3,Scan Actually Runs,Verify scan execution,Scan duration > 30 seconds,All test files,Timing proves scan actually ran,
Functional,9.4,Spider/Crawler Runs,Full scan spider execution,Multiple URLs discovered and tested,Full scan tests,Report shows > 1 URL tested,
Functional,9.5,Authentication Support,If auth configured,ZAP uses provided credentials,Manual test with auth config,Auth tokens in scan requests,
Detection,10.1,Detects XSS - Juice Shop,Known XSS in Juice Shop,XSS vulnerability found in full scan,test-zap-docker-juiceshop.yml (full),Report contains Cross-Site Scripting finding,
Detection,10.2,Detects SQL Injection - Juice Shop,Known SQLi in Juice Shop,SQL injection found in full scan,test-zap-docker-juiceshop.yml (full),Report contains SQL Injection finding,
Detection,10.3,Detects Missing Headers,Security header issues,Missing security headers found,test-zap-docker-juiceshop.yml (baseline),Report shows CSP and X-Frame-Options missing,
Detection,10.4,Detects XSS - DVWA,Known XSS in DVWA,XSS found in full scan,test-zap-docker-dvwa.yml (full),XSS vulnerability in report,
Detection,10.5,Detects SQL Injection - DVWA,Known SQLi in DVWA,SQL injection found,test-zap-docker-dvwa.yml (full),SQLi vulnerability in report,
Detection,10.6,Detects Testfire Vulnerabilities,Known issues on testfire.net,Finds documented testfire issues,test-zap-url-mode.yml,Detects testfire's intentional vulns,
Detection,10.7,Correct Severity Levels,Vulnerability severity classification,High/Medium/Low correctly assigned,All test files,Severity matches vulnerability type,
Detection,10.8,CWE Classification,Common Weakness Enumeration,CWE IDs present in findings,All test files,Each vuln has valid CWE number,
Detection,10.9,No False Positives on Clean App,Podinfo scan results,Minimal findings on secure app,test-zap-docker-podinfo.yml,No high/medium on podinfo baseline,
Documentation,11.1,README Lists ZAP,ZAP in scanner table,ZAP appears in README,PR diff review,ZAP row in scanner comparison table,
Documentation,11.2,ZAP Marked as Opt-In,Documentation clarity,Clearly states ZAP is opt-in,PR diff review,README explains why ZAP is opt-in,
Documentation,11.3,Scanners.md Updated,Scanner documentation,ZAP documentation added,PR diff review,docs/scanners.md has ZAP section,
Documentation,11.4,Configuration Examples,Usage examples provided,Examples show all scan modes,PR diff review,Docs show url/docker/compose examples,
Documentation,11.5,Threshold Options Documented,Failure threshold docs,All threshold values explained,PR diff review,Docs explain informational/low/medium/high,
Validation,12.1,Expected Vulnerabilities Found,Juice Shop validation,All expected vulns detected,Use validate-zap-results.sh,Script confirms expected findings,
Validation,12.2,Vulnerability Count Reasonable,Sanity check on findings,Finds realistic number of issues,All test files,Not 0 and not 1000+ findings,
Validation,12.3,Report Parseable,JSON format validation,JSON report valid and parseable,Use jq on report,jq successfully parses report,
Validation,12.4,Summary Formatting,GitHub summary readability,Summary is well-formatted,All test files,Markdown tables render correctly,
Security,13.1,No Hardcoded Secrets,Code review,No secrets in workflow files,Manual PR review,No API keys or credentials hardcoded,
Security,13.2,Proper Permissions,Workflow permissions,Minimum required permissions set,PR diff review,Permissions scope appropriate,
Security,13.3,Secure Report Handling,Sensitive data handling,Reports don't expose secrets,Manual review,No credentials in scan reports,
Security,13.4,Container Security,Docker image sources,Uses official/trusted images,PR diff review,ZAP image from official source,
Regression,14.1,Existing Scanners Still Work,No breaking changes,Trivy/Semgrep/etc still function,test-zap-integration.yml,Other scanners run successfully,
Regression,14.2,Default Behavior Unchanged,Backward compatibility,Workflows without ZAP unchanged,test-zap-integration.yml (scanners=all),No ZAP in default runs,
Regression,14.3,Existing Inputs Still Work,Parameter compatibility,Old workflow calls still valid,Manual test,Previous workflow configs still work,
