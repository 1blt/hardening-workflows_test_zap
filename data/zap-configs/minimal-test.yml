# ZAP DAST Scanner - Minimal Test Configuration
# Purpose: Test HRL workflow config support with minimal target load
#
# Target-friendly approach:
# - Only 3 scans total (reduced from 6)
# - All baseline scans (passive only, no active attacks)
# - One target per scan type to verify functionality
# - max_duration_minutes kept short

defaults:
  max_duration_minutes: 5
  fail_on_severity: none
  allow_failure: true
  post_pr_comment: false

scan_groups:
  # Group 1: URL-based scans - one reliable target
  - name: url-scans
    description: URL Mode Verification
    target:
      mode: url
    scans:
      # Test 1: Basic URL baseline scan
      - name: url-baseline
        type: baseline
        target_url: http://demo.testfire.net
        max_duration_minutes: 3

      # Test 2: Threshold enforcement works
      - name: threshold-test
        type: baseline
        target_url: http://demo.testfire.net
        fail_on_severity: high
        allow_failure: true

  # Group 2: Docker-based scan - self-contained, no external load
  - name: docker-scans
    description: Docker Mode Verification
    target:
      mode: docker-run
      image: ghcr.io/stefanprodan/podinfo:latest
      ports: "9898:9898"
    scans:
      # Test 3: Docker mode with clean app (minimal findings expected)
      - name: docker-baseline
        type: baseline
        target_url: http://localhost:9898
        max_duration_minutes: 3
