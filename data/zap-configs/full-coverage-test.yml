# ZAP DAST Scanner - Full Coverage Test (6 URL-based tests)
# Run with docker-test.yml for complete 7-test coverage
#
# Coverage Matrix:
# ┌─────────────────────┬──────────┬───────────┬───────────────┬─────────────────┐
# │ Test                │ Type     │ Threshold │ allow_failure │ Other           │
# ├─────────────────────┼──────────┼───────────┼───────────────┼─────────────────┤
# │ 1. url-baseline     │ baseline │ none      │ true          │ standard        │
# │ 2. url-full         │ full     │ none      │ true          │ active scan     │
# │ 3. url-api          │ api      │ none      │ true          │ OpenAPI spec    │
# │ 4. threshold-high   │ baseline │ high      │ true          │ strict threshold│
# │ 5. short-duration   │ baseline │ none      │ true          │ max_dur=2min    │
# │ 6. threshold-medium │ baseline │ medium    │ true          │ medium severity │
# └─────────────────────┴──────────┴───────────┴───────────────┴─────────────────┘
#
# Target: demo.testfire.net (reliable IBM test site)
# Exception: petstore.swagger.io for API test

target:
  mode: url

scans:
  # Test 1: Basic URL + Baseline (most common use case)
  - name: url-baseline
    type: baseline
    target_url: http://demo.testfire.net
    fail_on_severity: none
    allow_failure: true

  # Test 2: URL + Full Scan (active scanning)
  - name: url-full
    type: full
    target_url: http://demo.testfire.net
    fail_on_severity: none
    allow_failure: true
    max_duration_minutes: 5

  # Test 3: URL + API Scan (OpenAPI spec scanning)
  - name: url-api
    type: api
    target_url: https://petstore.swagger.io/v2
    api_spec: https://petstore.swagger.io/v2/swagger.json
    fail_on_severity: none
    allow_failure: true

  # Test 4: Threshold High (strict - only fail on high severity)
  - name: threshold-high
    type: baseline
    target_url: http://demo.testfire.net
    fail_on_severity: high
    allow_failure: true

  # Test 5: Short Duration (test max_duration_minutes limit)
  - name: short-duration
    type: baseline
    target_url: http://demo.testfire.net
    fail_on_severity: none
    allow_failure: true
    max_duration_minutes: 2

  # Test 6: Threshold Medium (moderate strictness)
  - name: threshold-medium
    type: baseline
    target_url: http://demo.testfire.net
    fail_on_severity: medium
    allow_failure: true
