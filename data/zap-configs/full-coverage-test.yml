# ZAP DAST Scanner - Full Coverage Test (7 tests, target-friendly)
#
# Strategy: Minimize external pinging by:
# 1. Running scans SEQUENTIALLY (one at a time)
# 2. Using ONE external target for URL tests (demo.testfire.net)
# 3. Using self-contained Docker for container mode test
# 4. Testing threshold variations on fast baseline scans
#
# Coverage:
# - scan_mode: url (tests 1-6), docker-run (test 7)
# - scan_type: baseline (1,4,5,6), full (2), api (3)
# - fail_on_severity: none (1,2,3), medium (5), high (4,6)
# - max_duration_minutes: 2 (6), 5 (2), default (others)
# - api_spec: test 3
# - container mode: test 7

target:
  mode: url

scans:
  # Test 1: URL + Baseline - Basic functionality
  - name: url-baseline
    type: baseline
    target_url: http://demo.testfire.net
    fail_on_severity: none
    allow_failure: true
    max_duration_minutes: 3

  # Test 2: URL + Full - Active scanning (limited duration to be gentle)
  - name: url-full
    type: full
    target_url: http://demo.testfire.net
    fail_on_severity: none
    allow_failure: true
    max_duration_minutes: 5

  # Test 3: URL + API - OpenAPI spec scanning
  - name: url-api
    type: api
    target_url: https://petstore.swagger.io/v2
    api_spec: https://petstore.swagger.io/v2/swagger.json
    fail_on_severity: none
    allow_failure: true
    max_duration_minutes: 3

  # Test 4: Threshold High - Verify threshold enforcement
  - name: threshold-high
    type: baseline
    target_url: http://demo.testfire.net
    fail_on_severity: high
    allow_failure: true
    max_duration_minutes: 2

  # Test 5: Threshold Medium - Moderate strictness
  - name: threshold-medium
    type: baseline
    target_url: http://demo.testfire.net
    fail_on_severity: medium
    allow_failure: true
    max_duration_minutes: 2

  # Test 6: Short Duration - Verify duration limit works
  - name: short-duration
    type: baseline
    target_url: http://demo.testfire.net
    fail_on_severity: high
    allow_failure: true
    max_duration_minutes: 2
